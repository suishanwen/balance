<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Config</title>
    <!--<script src="https://bitcoinrobot.cn/file/assets/bootstrap.4.1.3/js/jquery.slim.min.js"></script>-->
    <script src="https://bitcoinrobot.cn/file/assets/jquery.2.2.2/jquery.min.js"></script>
</head>
<body style="font-size: 30px">
<div>
    <div style="width: 100px;height: 100px;background: gray;display: inline-block;cursor: pointer"><span
            style="line-height: 100px;padding-left: 20px;" onclick="restart()">重启</span></div>
    <div style="width: 100px;height: 100px;background: gray;display: inline-block;cursor: pointer"
         onclick="shutdown()"><span
            style="line-height: 100px;padding-left: 20px;">结束</span></div>
    <div style="width: 100px;height: 100px;background: gray;display: inline-block;cursor: pointer"
         onclick="log()"><span
            style="line-height: 100px;padding-left: 20px;">日志</span></div>
</div>
<br>
#tbd
</body>
<script>
    const path = location.href.split(":")[0] + "://" + document.location.host;

    modify = (symbol, option) => {
        const id = `${symbol}_${option}`;
        let ele = $(`#${id}`);
        const test = $(`#${symbol}_${option}_val`);
        if (test.length === 0) {
            const input = $(`<input id="${symbol}_${option}_val" type="text" value="" style="font-size:30px"/>`);
            const submit = $(`<button id="${symbol}_${option}_submit" style="height:60px;width:60px;display:inline-block;" onclick="update('${symbol}','${option}')">修改</button>`);
            ele.append(input);
            ele.append(submit);
        } else {
            test.remove();
            $(`#${symbol}_${option}_submit`).remove();
        }
    };

    update = (symbol, option) => {
        const input = $(`#${symbol}_${option}_val`);
        const val = input.val();
        if (!input.val()) {
            alert("值不能为空！");
            return false;
        }
        const url = `${path}/modify?section=${symbol}&option=${option}&val=${val}`;
        console.log(url);
        $.get(url, null, (data) => {
            if (data === "ok") {
                $(`#${symbol}_${option}_val`).remove();
                $(`#${symbol}_${option}_submit`).remove();
                document.location.reload();
            }
        });
    };

    restart = () => {
        $.get(`${path}/restart`, null, (data) => {
            alert(data);
        });
    };

    shutdown = () => {
        $.get(`${path}/shutdown`, null, (data) => {
            alert(data);
        });
    };

    log = () => {
        location.href = `${path}/log`;
    };
</script>
</html>